[
  {
    "id": "msg-c003-001",
    "role": "user",
    "order_index": 1,
    "created_at": "2025-12-20T09:15:00Z",
    "content_md": "What are the best practices for using Next.js 14 App Router? I'm migrating from the Pages Router."
  },
  {
    "id": "msg-c003-002",
    "role": "assistant",
    "order_index": 2,
    "created_at": "2025-12-20T09:17:00Z",
    "content_md": "Great question! The App Router introduces significant changes. Here are the key best practices:\n\n## 1. Server vs Client Components\n\n**Default to Server Components** - they're the default in App Router:\n\n```tsx\n// app/page.tsx - Server Component by default\nexport default async function HomePage() {\n  const data = await fetchData();  // Can fetch directly!\n  return <div>{data.title}</div>;\n}\n```\n\n**Use `'use client'` only when needed:**\n\n```tsx\n'use client';\n\nimport { useState } from 'react';\n\nexport function Counter() {\n  const [count, setCount] = useState(0);  // Needs client-side state\n  return <button onClick={() => setCount(c => c + 1)}>{count}</button>;\n}\n```\n\n## 2. Data Fetching Patterns\n\n```tsx\n// Fetch data in Server Components\nasync function getData() {\n  const res = await fetch('https://api.example.com/data', {\n    next: { revalidate: 3600 }  // Cache for 1 hour\n  });\n  return res.json();\n}\n\nexport default async function Page() {\n  const data = await getData();\n  return <main>{/* Use data */}</main>;\n}\n```\n\n## 3. Layouts and Templates\n\n```\napp/\n├── layout.tsx        # Root layout (required)\n├── page.tsx          # Home page\n├── dashboard/\n│   ├── layout.tsx    # Dashboard-specific layout\n│   ├── page.tsx      # /dashboard\n│   └── settings/\n│       └── page.tsx  # /dashboard/settings\n```\n\n## 4. Loading and Error States\n\n```tsx\n// app/dashboard/loading.tsx\nexport default function Loading() {\n  return <Skeleton />;\n}\n\n// app/dashboard/error.tsx\n'use client';  // Error components must be client components\n\nexport default function Error({ error, reset }) {\n  return (\n    <div>\n      <h2>Something went wrong!</h2>\n      <button onClick={() => reset()}>Try again</button>\n    </div>\n  );\n}\n```\n\n## Key Migration Tips\n\n| Pages Router | App Router |\n|--------------|------------|\n| `getServerSideProps` | Direct `async` fetch in component |\n| `getStaticProps` | `fetch()` with caching options |\n| `_app.tsx` | `app/layout.tsx` |\n| `_document.tsx` | `app/layout.tsx` |\n| `useRouter` (pages) | `useRouter` (from `next/navigation`) |\n\nWould you like me to explain any specific migration pattern in more detail?"
  }
]
